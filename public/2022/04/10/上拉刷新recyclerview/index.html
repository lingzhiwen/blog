<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>
        Hexo
    </title>
    
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.1"></head>

<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-reply replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            上拉刷新，下拉加载的recyclerView
        </p>
        <hr>
    </div>
    <div class="post-content">
        <h3 id="1-上拉刷新的布局文件swipe-header-view"><a href="#1-上拉刷新的布局文件swipe-header-view" class="headerlink" title="1.上拉刷新的布局文件swipe_header_view"></a>1.上拉刷新的布局文件swipe_header_view</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;FrameLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;40dp&quot;</span><br><span class="line">    android:gravity=&quot;center&quot;&gt;</span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_gravity=&quot;center&quot;</span><br><span class="line">        android:gravity=&quot;center&quot;</span><br><span class="line">        android:orientation=&quot;horizontal&quot;&gt;</span><br><span class="line">        &lt;ProgressBar</span><br><span class="line">            android:id=&quot;@+id/progressbar&quot;</span><br><span class="line">            style=&quot;?android:attr/progressBarStyleSmallInverse&quot;</span><br><span class="line">            android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot; /&gt;</span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_marginStart=&quot;10dp&quot;</span><br><span class="line">            android:gravity=&quot;center&quot;</span><br><span class="line">            android:text=&quot;下拉刷新&quot; /&gt;</span><br><span class="line">    &lt;/LinearLayout&gt;</span><br><span class="line">&lt;/FrameLayout&gt;</span><br></pre></td></tr></table></figure>


<h3 id="2-下拉加载的布局文件swipe-footer-view"><a href="#2-下拉加载的布局文件swipe-footer-view" class="headerlink" title="2.下拉加载的布局文件swipe_footer_view"></a>2.下拉加载的布局文件swipe_footer_view</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;FrameLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;40dp&quot;</span><br><span class="line">    android:gravity=&quot;center&quot;&gt;</span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_gravity=&quot;center&quot;</span><br><span class="line">        android:gravity=&quot;center&quot;</span><br><span class="line">        android:orientation=&quot;horizontal&quot;&gt;</span><br><span class="line">        &lt;ProgressBar</span><br><span class="line">            android:id=&quot;@+id/progressbar&quot;</span><br><span class="line">            style=&quot;?android:attr/progressBarStyleSmallInverse&quot;</span><br><span class="line">            android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot; /&gt;</span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:id=&quot;@+id/footer_loading&quot;</span><br><span class="line">            android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_marginStart=&quot;10dp&quot;</span><br><span class="line">            android:gravity=&quot;center&quot;</span><br><span class="line">            android:text=&quot;加载中...&quot; /&gt;</span><br><span class="line">    &lt;/LinearLayout&gt;</span><br><span class="line">&lt;/FrameLayout&gt;</span><br></pre></td></tr></table></figure>



<h3 id="3-下拉刷新，上拉加载的recyclerview"><a href="#3-下拉刷新，上拉加载的recyclerview" class="headerlink" title="3.下拉刷新，上拉加载的recyclerview"></a>3.下拉刷新，上拉加载的recyclerview</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br></pre></td><td class="code"><pre><span class="line">import android.content.Context;</span><br><span class="line">import android.content.res.Resources;</span><br><span class="line">import android.util.AttributeSet;</span><br><span class="line">import android.util.Log;</span><br><span class="line">import android.view.Gravity;</span><br><span class="line">import android.view.MotionEvent;</span><br><span class="line">import android.view.View;</span><br><span class="line">import android.widget.LinearLayout;</span><br><span class="line">import android.widget.Scroller;</span><br><span class="line"></span><br><span class="line">import androidx.annotation.Nullable;</span><br><span class="line">import androidx.recyclerview.widget.RecyclerView;</span><br><span class="line">import androidx.recyclerview.widget.RecyclerView.Adapter;</span><br><span class="line"></span><br><span class="line">import org.jetbrains.annotations.NotNull;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public final class RecyclerRefreshLayout extends LinearLayout &#123;</span><br><span class="line">    @NotNull</span><br><span class="line">    private RecyclerView contentRv;</span><br><span class="line">    private final Scroller scroller;</span><br><span class="line">    @NotNull</span><br><span class="line">    private View headerView;</span><br><span class="line">    @NotNull</span><br><span class="line">    private View footerView;</span><br><span class="line">    private boolean isHeaderViewEnable;</span><br><span class="line">    private boolean isFooterViewEnable;</span><br><span class="line">    @Nullable</span><br><span class="line">    private RecyclerRefreshLayout.ActionListener actionListener;</span><br><span class="line">    private final int HEADER_HEIGHT;</span><br><span class="line">    private final int FOOTER_HEIGHT;</span><br><span class="line">    private final int MAX_SCROLL_DISTANCE;</span><br><span class="line">    private int layoutHeight;</span><br><span class="line">    private int layoutWidth;</span><br><span class="line">    private boolean isLoadData;</span><br><span class="line">    private float downY;</span><br><span class="line">    private float lastY;</span><br><span class="line">    private boolean rvIsArriveTop;</span><br><span class="line">    private boolean rvIsArriveDown;</span><br><span class="line">    private static final String TAG = &quot;SwipeLayout&quot;;</span><br><span class="line">    private static final int ANIM_DURATION = 300;</span><br><span class="line">    private static final float SCROLL_DISTANCE = 80.0F;</span><br><span class="line">    private float downX;</span><br><span class="line">    private long currentTimeMillis;</span><br><span class="line"></span><br><span class="line">    public RecyclerRefreshLayout(@NotNull Context ctx, @NotNull AttributeSet attr) &#123;</span><br><span class="line">        super(ctx, attr);</span><br><span class="line">        this.contentRv = new RecyclerView(ctx);</span><br><span class="line">        this.scroller = new Scroller(this.getContext());</span><br><span class="line">        this.headerView = View.inflate(this.getContext(), R.layout.swipe_header_view, null);</span><br><span class="line">        this.footerView = View.inflate(this.getContext(), R.layout.swipe_footer_view, null);</span><br><span class="line">        this.isHeaderViewEnable = true;</span><br><span class="line">        this.isFooterViewEnable = true;</span><br><span class="line">        HEADER_HEIGHT = dp2px(ctx, SCROLL_DISTANCE);</span><br><span class="line">        FOOTER_HEIGHT = dp2px(ctx, SCROLL_DISTANCE);</span><br><span class="line">        MAX_SCROLL_DISTANCE = dp2px(ctx, SCROLL_DISTANCE);</span><br><span class="line">        this.setGravity(Gravity.CENTER);</span><br><span class="line">        this.setOrientation(VERTICAL);</span><br><span class="line">        contentRv.setOverScrollMode(RecyclerView.OVER_SCROLL_NEVER);</span><br><span class="line">        this.post(() -&gt; &#123;</span><br><span class="line">            layoutHeight = getHeight();</span><br><span class="line">            layoutWidth = getWidth();</span><br><span class="line">            addView(getHeaderView(), (new LayoutParams(LayoutParams.MATCH_PARENT, HEADER_HEIGHT)));</span><br><span class="line">            addView(getContentRv(), (new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT)));</span><br><span class="line">            /** 一开始的时候要让Header和Footer看不见，设置向上的负paddingTop，paddingBottom */</span><br><span class="line">            setPadding(0, -HEADER_HEIGHT / 2, 0, -FOOTER_HEIGHT / 2);</span><br><span class="line">            addView(getFooterView(), (new LayoutParams(LayoutParams.MATCH_PARENT, FOOTER_HEIGHT)));</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @NotNull</span><br><span class="line">    public final RecyclerView getContentRv() &#123;</span><br><span class="line">        return this.contentRv;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public final void setContentRv(@NotNull RecyclerView var1) &#123;</span><br><span class="line">        this.contentRv = var1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @NotNull</span><br><span class="line">    public final View getHeaderView() &#123;</span><br><span class="line">        return this.headerView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public final void setHeaderView(@NotNull View value) &#123;</span><br><span class="line">        this.removeView(this.headerView);</span><br><span class="line">        this.headerView = value;</span><br><span class="line">        this.addView(this.headerView, 0, new LayoutParams(LayoutParams.MATCH_PARENT, this.HEADER_HEIGHT));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @NotNull</span><br><span class="line">    public final View getFooterView() &#123;</span><br><span class="line">        return this.footerView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public final void setFooterView(@NotNull View value) &#123;</span><br><span class="line">        this.removeView(this.footerView);</span><br><span class="line">        this.footerView = value;</span><br><span class="line">        this.addView(this.footerView, -1, (LayoutParams) (new LayoutParams(LayoutParams.MATCH_PARENT, this.FOOTER_HEIGHT)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public final boolean isHeaderViewEnable() &#123;</span><br><span class="line">        return this.isHeaderViewEnable;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public final void setHeaderViewEnable(boolean var1) &#123;</span><br><span class="line">        this.isHeaderViewEnable = var1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public final boolean isFooterViewEnable() &#123;</span><br><span class="line">        return this.isFooterViewEnable;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public final void setFooterViewEnable(boolean var1) &#123;</span><br><span class="line">        this.isFooterViewEnable = var1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Nullable</span><br><span class="line">    public final RecyclerRefreshLayout.ActionListener getActionListener() &#123;</span><br><span class="line">        return this.actionListener;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public final void setActionListener(@Nullable RecyclerRefreshLayout.ActionListener var1) &#123;</span><br><span class="line">        this.actionListener = var1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public boolean dispatchTouchEvent(@Nullable MotionEvent ev) &#123;</span><br><span class="line">        switch (ev.getAction()) &#123;</span><br><span class="line">            case MotionEvent.ACTION_DOWN:</span><br><span class="line">                this.downX = ev.getX();</span><br><span class="line">                this.downY = ev.getY();</span><br><span class="line">                this.lastY = ev.getY();</span><br><span class="line">                break;</span><br><span class="line">            case MotionEvent.ACTION_MOVE:</span><br><span class="line">                int disX = (int) Math.abs(ev.getX() - downX);</span><br><span class="line">                int disY = (int) Math.abs(ev.getY() - downY);</span><br><span class="line">                this.rvIsArriveTop = this.isArriveTop(this.contentRv);</span><br><span class="line">                this.rvIsArriveDown = this.isArriveBottom(this.contentRv);</span><br><span class="line">                /** 只允许纵向下拉刷新，解决嵌套viewpager滑动冲突。 */</span><br><span class="line">                if (!this.isLoadData &amp;&amp; disY &gt; disX) &#123;</span><br><span class="line">                    this.scrollLayout(ev.getY());</span><br><span class="line">                &#125;</span><br><span class="line">                this.lastY = ev.getY();</span><br><span class="line">                break;</span><br><span class="line">            case MotionEvent.ACTION_UP:</span><br><span class="line">                int scrollY = this.getScrollY();</span><br><span class="line">                if (Math.abs(scrollY) &gt;= this.MAX_SCROLL_DISTANCE / 2 &amp; !this.isLoadData) &#123;</span><br><span class="line">                    this.isLoadData = true;</span><br><span class="line">                    if (this.rvIsArriveTop) &#123;</span><br><span class="line">                        this.startRefresh();</span><br><span class="line">                    &#125; else if (this.rvIsArriveDown) &#123;</span><br><span class="line">                        this.startLoadMore();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    this.smoothResetScroll();</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line"></span><br><span class="line">            case MotionEvent.ACTION_CANCEL:</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">        return super.dispatchTouchEvent(ev);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private final void scrollLayout(float moveY) &#123;</span><br><span class="line">        float nextScrollY = (float) this.getScrollY() + this.lastY - moveY;</span><br><span class="line">        if (this.rvIsArriveTop) &#123;</span><br><span class="line">            this.pullDownScroll(nextScrollY);</span><br><span class="line">        &#125; else if (this.rvIsArriveDown) &#123;</span><br><span class="line">            this.pullUpScroll(nextScrollY);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private final void pullDownScroll(float nextScrollY) &#123;</span><br><span class="line">        if (this.isHeaderViewEnable) &#123;</span><br><span class="line">            if (nextScrollY &gt;= (float) 0) &#123;</span><br><span class="line">                this.scrollTo(0, 0);</span><br><span class="line">            &#125; else if (nextScrollY &lt; (float) (-this.MAX_SCROLL_DISTANCE)) &#123;</span><br><span class="line">                this.scrollTo(0, -this.MAX_SCROLL_DISTANCE);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                this.scrollTo(0, (int) nextScrollY);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private final void pullUpScroll(float nextScrollY) &#123;</span><br><span class="line">        if (this.isFooterViewEnable) &#123;</span><br><span class="line">            if (nextScrollY &lt; (float) 0) &#123;</span><br><span class="line">                this.scrollTo(0, 0);</span><br><span class="line">            &#125; else if (nextScrollY &gt; (float) this.MAX_SCROLL_DISTANCE) &#123;</span><br><span class="line">                this.scrollTo(0, this.MAX_SCROLL_DISTANCE);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                this.scrollTo(0, (int) nextScrollY);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public final void startRefresh() &#123;</span><br><span class="line">        if (this.isHeaderViewEnable) &#123;</span><br><span class="line">            this.isLoadData = true;</span><br><span class="line">            this.contentRv.smoothScrollToPosition(0);</span><br><span class="line">            this.scroller.startScroll(0, this.getScrollY(), 0, -this.MAX_SCROLL_DISTANCE - this.getScrollY());</span><br><span class="line">            if (this.actionListener != null) &#123;</span><br><span class="line">                long diffTime = System.currentTimeMillis() - currentTimeMillis;</span><br><span class="line">                if (diffTime &gt; 200) &#123;</span><br><span class="line">                    this.actionListener.onRefresh();</span><br><span class="line">                &#125;</span><br><span class="line">                currentTimeMillis = System.currentTimeMillis();</span><br><span class="line">            &#125;</span><br><span class="line">            this.invalidate();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public final void startLoadMore() &#123;</span><br><span class="line">        if (!isFooterViewEnable) return;</span><br><span class="line">        this.isLoadData = true;</span><br><span class="line">        Adapter adapter = this.contentRv.getAdapter();</span><br><span class="line">        if (adapter == null) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        int itemCount = adapter.getItemCount();</span><br><span class="line">        this.contentRv.smoothScrollToPosition(itemCount &gt; 0 ? itemCount - 1 : 0);</span><br><span class="line">        this.scroller.startScroll(0, this.getScrollY(), 0, this.MAX_SCROLL_DISTANCE - this.getScrollY());</span><br><span class="line">        if (this.actionListener != null) &#123;</span><br><span class="line">            this.actionListener.onLoadMore();</span><br><span class="line">        &#125;</span><br><span class="line">        this.invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public final void smoothResetScroll() &#123;</span><br><span class="line">        this.scroller.startScroll(0, this.getScrollY(), 0, -this.getScrollY(), ANIM_DURATION);</span><br><span class="line">        this.isLoadData = false;</span><br><span class="line">        this.invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private final boolean isArriveTop(RecyclerView rv) &#123;</span><br><span class="line">        return !rv.canScrollVertically(-1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private final boolean isArriveBottom(RecyclerView rv) &#123;</span><br><span class="line">        return !rv.canScrollVertically(1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private final int dp2px(Context ctx, float dpValue) &#123;</span><br><span class="line">        Resources resources = ctx.getApplicationContext().getResources();</span><br><span class="line">        float scale = resources.getDisplayMetrics().density;</span><br><span class="line">        return (int) (dpValue * scale + 0.5F);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void computeScroll() &#123;</span><br><span class="line">        if (this.scroller.computeScrollOffset()) &#123;</span><br><span class="line">            this.scrollTo(0, this.scroller.getCurrY());</span><br><span class="line">            this.postInvalidate();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public interface ActionListener &#123;</span><br><span class="line">        void onRefresh();</span><br><span class="line"></span><br><span class="line">        void onLoadMore();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
    </div>

    
        <hr class="fhr">
        <div id="vcomments"></div>
    
</div>
    <div class="footer" id="footer">
    <p>Copyright © 2022 <a class="flink" target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>.
        <label class="el-switch el-switch-green el-switch-sm" style="vertical-align: sub;">
            <input type="checkbox" name="switch" id="update_style">
            <span class="el-switch-style"></span>
        </label>
<!--         <script type="text/javascript">
        var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
        document.write(unescape("%3Cspan id='cnzz_stat_icon_1278548644'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278548644%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
        </script> -->
    </p>
</div>
<input type="hidden" id="web_style" value="black">
<input type="hidden" id="valine_appid" value="uSAMAGFceyOOgNeJHudPxcAP-gzGzoHsz">
<input type="hidden" id="valine_appKey" value="JeTNBu6ko9aHCDetzbK2jjDK">

<script src="/libs/jquery.min.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>

<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>

<script src="/js/js.js"></script>

<style type="text/css">
.v * {
    color: #698fca;
}

.v .vlist .vcard .vhead .vsys {
    color: #3a3e4a;
}

.v .vlist .vcard .vh .vmeta .vat {
    color: #638fd5;
}

.v .vlist .vcard .vhead .vnick {
    color: #6ba1ff;
}

.v a {
    color: #8696b1;
}

.v .vlist .vcard .vhead .vnick:hover {
    color: #669bfc;
}
</style>
</body>

</html>